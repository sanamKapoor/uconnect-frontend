{"version":3,"sources":["img/user.jpg","Layout/Pages/SignUp.js","Layout/components/Common/UIElements/ProfilePicUploader.js","../node_modules/downloadjs/download.js"],"names":["module","exports","SignUp","dispatch","useDispatch","useSelector","state","modal","modalLoading","modalErrorMsg","modalSuccessMsg","showSuccessToast","useState","username","setUserName","email","setEmail","password","setPassword","url","setUrl","imgId","setimgId","image","setImage","defaultImage","preview","setPreview","disable","setDisable","useEffect","fileReader","FileReader","onload","result","readAsDataURL","modalError","modalMsg","timer","setTimeout","showSuccessToastFun","clearTimeout","msg","className","src","classes","fileHandler","e","target","files","length","file","type","data","FormData","append","process","fetch","method","body","then","res","json","secure_url","public_id","catch","err","btnText","btnClass","onSubmit","preventDefault","trim","formData","JSON","stringify","backendReqModal","href","inputType","inputName","inputText","checkText","inputValue","maxLength","minLength","onChangeHandler","value","disabled","to","ProfilePicUploader","filePickerRef","createRef","ref","style","accept","onChange","onClick","current","click","define","download","strFileName","strMimeType","blob","reader","self","window","defaultMime","mimeType","payload","anchor","document","createElement","toString","a","String","myBlob","Blob","MozBlob","WebKitBlob","fileName","call","bind","this","split","pop","indexOf","ajax","XMLHttpRequest","open","responseType","response","send","test","navigator","msSaveBlob","dataUrlToBlob","saver","i","tempUiArr","Uint8Array","mx","charCodeAt","strUrl","parts","binData","atob","decodeURIComponent","uiArr","winMode","setAttribute","innerHTML","display","appendChild","removeChild","URL","revokeObjectURL","userAgent","replace","confirm","location","f","createObjectURL","constructor","btoa","y","encodeURIComponent"],"mappings":"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","file":"static/js/12.f3c2f08e.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/user.5d288f42.jpg\";","import React from 'react';\r\nimport { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport ShowToast from '../components/Common/UIElements/ShowToast';\r\nimport InputElement from '../components/Common/UIElements/InputElement';\r\nimport ProfilePicUploader from '../components/Common/UIElements/ProfilePicUploader';\r\nimport ShowImage from '../components/Common/UIElements/ShowImage';\r\n\r\nimport defaultImage from '../../img/user.jpg';\r\nimport { backendReqModal, modalError, modalMsg, showSuccessToastFun } from '../../redux/actions/modalActions';\r\n\r\nfunction SignUp() {\r\n\r\n    const dispatch = useDispatch();\r\n    const { modalLoading, modalErrorMsg, modalSuccessMsg, showSuccessToast } = useSelector(state => state.modal);\r\n\r\n    const [username, setUserName] = useState('');\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [url, setUrl] = useState('');\r\n    const [imgId, setimgId] = useState('');\r\n\r\n    const [image, setImage] = useState(null);\r\n    const [preview, setPreview] = useState(defaultImage);\r\n    const [disable, setDisable] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if(!image){\r\n            return;\r\n        }\r\n        const fileReader = new FileReader();\r\n        fileReader.onload = () => {\r\n            setPreview(fileReader.result)\r\n        }\r\n        fileReader.readAsDataURL(image);\r\n    }, [image])\r\n\r\n    useEffect(() => {\r\n        dispatch(modalError(''))\r\n        dispatch(modalMsg(''))\r\n    }, [dispatch])\r\n\r\n    useEffect(() => {\r\n        if(modalSuccessMsg !== '' && modalErrorMsg === ''){\r\n            setUserName('')\r\n            setEmail('')\r\n            setImage(null)\r\n            setPassword('')\r\n            setPreview(defaultImage)\r\n        }\r\n    }, [modalErrorMsg, modalSuccessMsg])\r\n\r\n    useEffect(() => {\r\n        const timer = setTimeout(() => {\r\n            modalErrorMsg && dispatch(modalError(''))\r\n            modalSuccessMsg && dispatch(modalMsg(''))\r\n            !showSuccessToast && dispatch(showSuccessToastFun(true))\r\n          }, 2000)\r\n    \r\n          return () => {\r\n            clearTimeout(timer);\r\n          }\r\n    }, [dispatch, modalErrorMsg, modalSuccessMsg, showSuccessToast])\r\n\r\n    const fileHandler = e => {\r\n        if(e.target.files && e.target.files.length === 1){\r\n\r\n            setImage(e.target.files[0])\r\n            const file = e.target.files[0];\r\n\r\n            if(file.type === \"image/jpg\" || file.type === \"image/png\" || file.type === \"image/jpeg\") {\r\n\r\n            setDisable(true);\r\n            const data = new FormData()\r\n            data.append(\"file\", file)\r\n            data.append(\"upload_preset\", process.env.REACT_APP_PRESET)\r\n            data.append(\"cloud_name\", process.env.REACT_APP_CLOUD_NAME)\r\n\r\n            fetch(`${process.env.REACT_APP_CLOUDINARY_URL}/${process.env.REACT_APP_CLOUD_NAME}/image/upload`, {\r\n                method:\"post\",\r\n                body: data\r\n            })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n                setUrl(data.secure_url)\r\n                setimgId(data.public_id)\r\n                setDisable(false);\r\n                dispatch(modalError(''))\r\n            })\r\n            .catch(err=> {\r\n                dispatch(modalError('Something went wrong'))\r\n            })\r\n         } else {\r\n            dispatch(modalError('Invalid file type'))\r\n            return;\r\n         }\r\n        }\r\n    }\r\n\r\n    const submitHandler = e => {\r\n        e.preventDefault();\r\n\r\n        if(username.trim() === '' || email.trim() === '' || password.trim() === ''){\r\n            dispatch(modalError('Please provide auth credentials'))\r\n            return;\r\n        }\r\n\r\n        if (image === null) {\r\n            dispatch(modalError('Please provide profile picture'))\r\n            return;\r\n        }\r\n\r\n        let formData = JSON.stringify({\r\n            username,\r\n            email,\r\n            password,\r\n            image: url,\r\n            imgId\r\n        })\r\n\r\n        dispatch(backendReqModal('/auth/register', 'POST', formData, { 'Content-Type': 'application/json' }))\r\n\r\n    }\r\n\r\n    return (\r\n        <>\r\n        { (modalSuccessMsg && showSuccessToast) && <ShowToast msg={modalSuccessMsg} /> } \r\n        <div className=\"auth-section\">\r\n        <section className=\"signup\">\r\n        <div className=\"row no-gutters m-3 shadow-lg\">\r\n            <div className=\"col-12 col-lg-5 bg-warning user-image py-3\">\r\n                <ShowImage src={preview} classes=\"rounded-circle\" />\r\n                <ProfilePicUploader \r\n                    fileHandler={fileHandler}\r\n                    btnText=\"Upload Image\"\r\n                    disable={disable}\r\n                    btnClass=\"mt-3 btn btn-secondary btn-sm rounded-pill px-lg-4 py-lg-2 px-3 py-1\"\r\n                />\r\n            </div>\r\n            <div className=\"col-12 col-lg-7\">\r\n                <form onSubmit={submitHandler} className=\"form signup-form p-3 p-lg-4 p-xl-5 text-center bg-light\">\r\n                    <div className=\"pb-lg-3 pb-md-2 pb-1\">\r\n                        <div className=\"logo\">\r\n                            <h1>UConnect </h1>\r\n                        </div>\r\n                        <p className=\"text-muted mx-2 welcome-p\">Share your enjoying moments with friends and family!</p>\r\n                        <a href={`${process.env.REACT_APP_BACKEND_URL}/auth/google`} className=\"btn btn-light rounded-pill shadow\"><i className=\"fab fa-google text-secondary mr-1 mr-sm-2\"></i> Login with Google</a>\r\n                    </div>\r\n                    <div>\r\n                        <InputElement \r\n                            inputType=\"text\" \r\n                            inputName=\"name\" \r\n                            classes=\"form-control my-2 my-md-3\" \r\n                            inputText=\"ðŸ‘¨  Username\"\r\n                            checkText={true} \r\n                            inputValue={username}\r\n                            maxLength={20}\r\n                            minLength={3}\r\n                            onChangeHandler={e => setUserName(e.target.value)}\r\n                        />\r\n                        <InputElement \r\n                            inputType=\"email\" \r\n                            inputName=\"email\" \r\n                            inputText=\"ðŸ“§ Email\" \r\n                            classes=\"form-control my-2 my-md-3\" \r\n                            inputValue={email}\r\n                            onChangeHandler={e => setEmail(e.target.value)}\r\n                        />\r\n                        <InputElement \r\n                            inputType=\"password\" \r\n                            inputName=\"password\" \r\n                            inputText=\"ðŸ”’  Password\" \r\n                            minLength={5}\r\n                            maxLength={20}\r\n                            classes=\"form-control my-2 my-md-3\" \r\n                            inputValue={password}\r\n                            onChangeHandler={e => setPassword(e.target.value)}\r\n                        />\r\n                        {\r\n                            modalErrorMsg && \r\n                            <span className=\"text-danger text-center\"> \r\n                                {modalErrorMsg}\r\n                            </span>\r\n                        }\r\n                        <button type=\"submit\" disabled={disable} className=\"btn btn-block btn-secondary my-3 shadow\">\r\n                            { (disable || modalLoading) ? 'Please wait...' : 'Sign Up'}\r\n                        </button>\r\n                    </div>\r\n                    <Link to=\"/login\" className=\"text-secondary\">Already have an account?</Link>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </section>\r\n    </div>\r\n    </>\r\n    )\r\n}\r\n\r\nexport default SignUp\r\n","import React, { createRef } from 'react'\r\n\r\nfunction ProfilePicUploader({fileHandler, btnText, btnClass, disable}) {\r\n    const filePickerRef = createRef();\r\n\r\n    const pickerFileHandler = () => {\r\n        filePickerRef.current.click();\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <input \r\n                type=\"file\"\r\n                ref={filePickerRef}\r\n                style={{\"display\": \"none\"}}\r\n                accept=\".jpg,.jpeg,.png\"\r\n                onChange={fileHandler}\r\n                />\r\n            <button className={btnClass} disabled={disable} onClick={pickerFileHandler}>{btnText}</button>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default ProfilePicUploader\r\n","//download.js v4.2, by dandavis; 2008-2016. [MIT] see http://danml.com/download.html for tests/usage\n// v1 landed a FF+Chrome compat way of downloading strings to local un-named files, upgraded to use a hidden frame and optional mime\n// v2 added named files via a[download], msSaveBlob, IE (10+) support, and window.URL support for larger+faster saves than dataURLs\n// v3 added dataURL and Blob Input, bind-toggle arity, and legacy dataURL fallback was improved with force-download mime and base64 support. 3.1 improved safari handling.\n// v4 adds AMD/UMD, commonJS, and plain browser support\n// v4.1 adds url download capability via solo URL argument (same domain/CORS only)\n// v4.2 adds semantic variable names, long (over 2MB) dataURL support, and hidden by default temp anchors\n// https://github.com/rndme/download\n\n(function (root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine([], factory);\n\t} else if (typeof exports === 'object') {\n\t\t// Node. Does not work with strict CommonJS, but\n\t\t// only CommonJS-like environments that support module.exports,\n\t\t// like Node.\n\t\tmodule.exports = factory();\n\t} else {\n\t\t// Browser globals (root is window)\n\t\troot.download = factory();\n  }\n}(this, function () {\n\n\treturn function download(data, strFileName, strMimeType) {\n\n\t\tvar self = window, // this script is only for browsers anyway...\n\t\t\tdefaultMime = \"application/octet-stream\", // this default mime also triggers iframe downloads\n\t\t\tmimeType = strMimeType || defaultMime,\n\t\t\tpayload = data,\n\t\t\turl = !strFileName && !strMimeType && payload,\n\t\t\tanchor = document.createElement(\"a\"),\n\t\t\ttoString = function(a){return String(a);},\n\t\t\tmyBlob = (self.Blob || self.MozBlob || self.WebKitBlob || toString),\n\t\t\tfileName = strFileName || \"download\",\n\t\t\tblob,\n\t\t\treader;\n\t\t\tmyBlob= myBlob.call ? myBlob.bind(self) : Blob ;\n\t  \n\t\tif(String(this)===\"true\"){ //reverse arguments, allowing download.bind(true, \"text/xml\", \"export.xml\") to act as a callback\n\t\t\tpayload=[payload, mimeType];\n\t\t\tmimeType=payload[0];\n\t\t\tpayload=payload[1];\n\t\t}\n\n\n\t\tif(url && url.length< 2048){ // if no filename and no mime, assume a url was passed as the only argument\n\t\t\tfileName = url.split(\"/\").pop().split(\"?\")[0];\n\t\t\tanchor.href = url; // assign href prop to temp anchor\n\t\t  \tif(anchor.href.indexOf(url) !== -1){ // if the browser determines that it's a potentially valid url path:\n        \t\tvar ajax=new XMLHttpRequest();\n        \t\tajax.open( \"GET\", url, true);\n        \t\tajax.responseType = 'blob';\n        \t\tajax.onload= function(e){ \n\t\t\t\t  download(e.target.response, fileName, defaultMime);\n\t\t\t\t};\n        \t\tsetTimeout(function(){ ajax.send();}, 0); // allows setting custom ajax headers using the return:\n\t\t\t    return ajax;\n\t\t\t} // end if valid url?\n\t\t} // end if url?\n\n\n\t\t//go ahead and download dataURLs right away\n\t\tif(/^data:([\\w+-]+\\/[\\w+.-]+)?[,;]/.test(payload)){\n\t\t\n\t\t\tif(payload.length > (1024*1024*1.999) && myBlob !== toString ){\n\t\t\t\tpayload=dataUrlToBlob(payload);\n\t\t\t\tmimeType=payload.type || defaultMime;\n\t\t\t}else{\t\t\t\n\t\t\t\treturn navigator.msSaveBlob ?  // IE10 can't do a[download], only Blobs:\n\t\t\t\t\tnavigator.msSaveBlob(dataUrlToBlob(payload), fileName) :\n\t\t\t\t\tsaver(payload) ; // everyone else can save dataURLs un-processed\n\t\t\t}\n\t\t\t\n\t\t}else{//not data url, is it a string with special needs?\n\t\t\tif(/([\\x80-\\xff])/.test(payload)){\t\t\t  \n\t\t\t\tvar i=0, tempUiArr= new Uint8Array(payload.length), mx=tempUiArr.length;\n\t\t\t\tfor(i;i<mx;++i) tempUiArr[i]= payload.charCodeAt(i);\n\t\t\t \tpayload=new myBlob([tempUiArr], {type: mimeType});\n\t\t\t}\t\t  \n\t\t}\n\t\tblob = payload instanceof myBlob ?\n\t\t\tpayload :\n\t\t\tnew myBlob([payload], {type: mimeType}) ;\n\n\n\t\tfunction dataUrlToBlob(strUrl) {\n\t\t\tvar parts= strUrl.split(/[:;,]/),\n\t\t\ttype= parts[1],\n\t\t\tdecoder= parts[2] == \"base64\" ? atob : decodeURIComponent,\n\t\t\tbinData= decoder( parts.pop() ),\n\t\t\tmx= binData.length,\n\t\t\ti= 0,\n\t\t\tuiArr= new Uint8Array(mx);\n\n\t\t\tfor(i;i<mx;++i) uiArr[i]= binData.charCodeAt(i);\n\n\t\t\treturn new myBlob([uiArr], {type: type});\n\t\t }\n\n\t\tfunction saver(url, winMode){\n\n\t\t\tif ('download' in anchor) { //html5 A[download]\n\t\t\t\tanchor.href = url;\n\t\t\t\tanchor.setAttribute(\"download\", fileName);\n\t\t\t\tanchor.className = \"download-js-link\";\n\t\t\t\tanchor.innerHTML = \"downloading...\";\n\t\t\t\tanchor.style.display = \"none\";\n\t\t\t\tdocument.body.appendChild(anchor);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tanchor.click();\n\t\t\t\t\tdocument.body.removeChild(anchor);\n\t\t\t\t\tif(winMode===true){setTimeout(function(){ self.URL.revokeObjectURL(anchor.href);}, 250 );}\n\t\t\t\t}, 66);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// handle non-a[download] safari as best we can:\n\t\t\tif(/(Version)\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari\\//.test(navigator.userAgent)) {\n\t\t\t\tif(/^data:/.test(url))\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t\tif(!window.open(url)){ // popup blocked, offer direct download:\n\t\t\t\t\tif(confirm(\"Displaying New Document\\n\\nUse Save As... to download, then click back to return to this page.\")){ location.href=url; }\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t//do iframe dataURL download (old ch+FF):\n\t\t\tvar f = document.createElement(\"iframe\");\n\t\t\tdocument.body.appendChild(f);\n\n\t\t\tif(!winMode && /^data:/.test(url)){ // force a mime that will download:\n\t\t\t\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t}\n\t\t\tf.src=url;\n\t\t\tsetTimeout(function(){ document.body.removeChild(f); }, 333);\n\n\t\t}//end saver\n\n\n\n\n\t\tif (navigator.msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\n\t\t\treturn navigator.msSaveBlob(blob, fileName);\n\t\t}\n\n\t\tif(self.URL){ // simple fast and modern way using Blob and URL:\n\t\t\tsaver(self.URL.createObjectURL(blob), true);\n\t\t}else{\n\t\t\t// handle non-Blob()+non-URL browsers:\n\t\t\tif(typeof blob === \"string\" || blob.constructor===toString ){\n\t\t\t\ttry{\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \";base64,\"  +  self.btoa(blob)  );\n\t\t\t\t}catch(y){\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \",\" + encodeURIComponent(blob)  );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Blob but not URL support:\n\t\t\treader=new FileReader();\n\t\t\treader.onload=function(e){\n\t\t\t\tsaver(this.result);\n\t\t\t};\n\t\t\treader.readAsDataURL(blob);\n\t\t}\n\t\treturn true;\n\t}; /* end download() */\n}));\n"],"sourceRoot":""}